flowchart TD
    subgraph User[User Cancellation]
        A1[User Initiates Cancellation] --> A2{Type?}
        A2 -->|Volunteer| B1[Cancel Volunteer Shift]
        A2 -->|Drop-off| B2[Cancel Drop-off Slot]
        A2 -->|Pickup| B3[Cancel Pickup Slot]
    end

    subgraph Processing[System Processing]
        B1 --> C1[Update Volunteer Schedule]
        B2 --> C2[Update Drop-off Schedule]
        B3 --> C3[Update Pickup Schedule]
        
        C1 --> D1[Recalculate Bonus]
        C2 --> D2[Free Drop-off Slot]
        C3 --> D3[Free Pickup Slot]
        
        D1 --> E1[Send Volunteer Email]
        D2 --> E2[Send Drop-off Email]
        D3 --> E3[Send Pickup Email]
    end

    subgraph Recovery[Slot Recovery]
        F1[Make Volunteer Slot Available]
        F2[Make Drop-off Slot Available]
        F3[Make Pickup Slot Available]
        
        D1 --> F1
        D2 --> F2
        D3 --> F3
    end

    subgraph Notifications[Email System]
        E1 --> G1[Volunteer Cancellation Notice]
        E2 --> G2[Drop-off Cancellation Notice]
        E3 --> G3[Pickup Cancellation Notice]
        
        G1 --> H1[Alternative Shift Options]
        G2 --> H2[Rebooking Instructions]
        G3 --> H3[Alternative Slot Options]
    end

    style User fill:#f9f,stroke:#333,stroke-width:4px
    style Processing fill:#bbf,stroke:#333,stroke-width:4px
    style Recovery fill:#bfb,stroke:#333,stroke-width:4px
    style Notifications fill:#fbf,stroke:#333,stroke-width:4px