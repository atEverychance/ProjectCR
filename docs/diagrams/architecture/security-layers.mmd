flowchart TD
    subgraph Authentication[Authentication Layer]
        A1[Clerk.dev Integration] --> A2[User Registration/Login]
        A1 --> A3[Email Verification]
        A1 --> A4[Password Management]
        A1 --> A5[Session Handling]
        A6[Token Management] --> A7[JWT Validation]
        A6 --> A8[Token Refresh]
        A6 --> A9[Session Timeout]
        A6 --> A10[Device Tracking]
        A11[Multi-factor Auth] --> A12[Email Verification]
        A11 --> A13[2FA for Admins]
        A11 --> A14[Device Fingerprinting]
        A11 --> A15[Login Monitoring]
    end

    subgraph Authorization[Authorization Layer]
        B1[Role-Based Access] --> B2[Super Admin]
        B1 --> B3[Client Admin]
        B1 --> B4[Event Admin]
        B1 --> B5[Support Staff]
        B6[Consignor Roles] --> B7[Regular Consignor]
        B6 --> B8[Super Consignor]
        B6 --> B9[Volunteer]
        B10[Permissions] --> B11[Read Access]
        B10 --> B12[Write Access]
        B10 --> B13[Delete Access]
        B10 --> B14[Admin Actions]
        B15[Multi-tenant Security] --> B16[Client Isolation]
        B15 --> B17[Resource Ownership]
        B15 --> B18[Cross-tenant Protection]
        B15 --> B19[Access Validation]
    end

    subgraph DataProtection[Data Protection Layer]
        C1[Client Isolation] --> C2[Domain Separation]
        C1 --> C3[Data Partitioning]
        C1 --> C4[Cache Isolation]
        C1 --> C5[Resource Protection]
        C6[Sensitive Data] --> C7[Password Security]
        C6 --> C8[API Key Encryption]
        C6 --> C9[Personal Data Protection]
        C6 --> C10[Payment Info Handling]
        C11[Data Transmission] --> C12[TLS Encryption]
        C11 --> C13[Secure Webhooks]
        C11 --> C14[API Security]
        C11 --> C15[File Transfer Protection]
    end

    subgraph APISecurity[API Security Layer]
        D1[Request Validation] --> D2[Input Sanitization]
        D1 --> D3[Parameter Validation]
        D1 --> D4[Type Checking]
        D1 --> D5[Size Limits]
        D6[Rate Limiting] --> D7[Client Limits]
        D6 --> D8[Endpoint Limits]
        D6 --> D9[Burst Allowance]
        D6 --> D10[Rate Monitoring]
        D11[Webhook Security] --> D12[Signature Verification]
        D11 --> D13[Replay Protection]
        D11 --> D14[IP Whitelisting]
        D11 --> D15[Timeout Handling]
    end

    subgraph Monitoring[Monitoring & Auditing]
        E1[Security Monitoring] --> E2[Auth Attempts]
        E1 --> E3[AuthZ Failures]
        E1 --> E4[Rate Limit Violations]
        E1 --> E5[Suspicious Activity]
        E6[Audit Logging] --> E7[Auth Events]
        E6 --> E8[Admin Actions]
        E6 --> E9[Data Modifications]
        E6 --> E10[Access Attempts]
        E11[Alert System] --> E12[Security Violations]
        E11 --> E13[Multiple Failures]
        E11 --> E14[Unusual Activity]
        E11 --> E15[System Attacks]
    end

    subgraph IncidentResponse[Incident Response]
        F1[Detection] --> F2[Real-time Monitoring]
        F1 --> F3[Pattern Recognition]
        F1 --> F4[Anomaly Detection]
        F1 --> F5[Alert Generation]
        F6[Response Procedures] --> F7[Incident Classification]
        F6 --> F8[Response Protocols]
        F6 --> F9[Communication Plan]
        F6 --> F10[Recovery Procedures]
        F11[Recovery Process] --> F12[Account Recovery]
        F11 --> F13[Data Restoration]
        F11 --> F14[Access Restoration]
        F11 --> F15[Incident Documentation]
    end

    subgraph Compliance[Compliance Layer]
        G1[Data Privacy] --> G2[Personal Data Handling]
        G1 --> G3[Data Retention]
        G1 --> G4[Data Deletion]
        G1 --> G5[Privacy Notices]
        G6[Security Standards] --> G7[Password Requirements]
        G6 --> G8[Session Management]
        G6 --> G9[Access Control]
        G6 --> G10[Data Protection]
        G11[Audit Requirements] --> G12[Activity Logging]
        G11 --> G13[Change Tracking]
        G11 --> G14[Access Records]
        G11 --> G15[Compliance Reporting]
    end

    Authentication --> Authorization
    Authorization --> DataProtection
    DataProtection --> APISecurity
    APISecurity --> Monitoring
    Monitoring --> IncidentResponse
    IncidentResponse --> Compliance